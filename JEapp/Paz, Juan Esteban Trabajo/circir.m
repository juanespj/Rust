% Progarama para calcular el punto de intersección de dos líneas
% DATOS DE INGRESO
% Puntos del centro del circulo 1 (Ax,Ay) y Radio R1
% Puntos del dentro del circulo 2 (Bx,By) y Radio R2
% SALIDA
% Devuelve los puntos de intersección (Px,Py) y (Qx,Qy)
function [ Px,Py,Qx,Qy ] = circir( Ax,Ay,R1,Bx,By,R2)
    % Verificar si hay intersección
    dist = ((Bx-Ax)^2+(By-Ay)^2)^2;
    if(dist>R1+R2)
        error('No existe intersección entre los círculos');
    end
    % calcular la intersección
         
    Px=Ax/2 + Bx/2 - (Ax*R1^2)/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) + (Ax*R2^2)/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) + (Bx*R1^2)/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) - (Bx*R2^2)/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) + (Ay*(- Ax^4 + 4*Ax^3*Bx - 2*Ax^2*Ay^2 + 4*Ax^2*Ay*By - 6*Ax^2*Bx^2 - 2*Ax^2*By^2 + 2*Ax^2*R1^2 + 2*Ax^2*R2^2 + 4*Ax*Ay^2*Bx - 8*Ax*Ay*Bx*By + 4*Ax*Bx^3 + 4*Ax*Bx*By^2 - 4*Ax*Bx*R1^2 - 4*Ax*Bx*R2^2 - Ay^4 + 4*Ay^3*By - 2*Ay^2*Bx^2 - 6*Ay^2*By^2 + 2*Ay^2*R1^2 + 2*Ay^2*R2^2 + 4*Ay*Bx^2*By + 4*Ay*By^3 - 4*Ay*By*R1^2 - 4*Ay*By*R2^2 - Bx^4 - 2*Bx^2*By^2 + 2*Bx^2*R1^2 + 2*Bx^2*R2^2 - By^4 + 2*By^2*R1^2 + 2*By^2*R2^2 - R1^4 + 2*R1^2*R2^2 - R2^4)^(1/2))/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) - (By*(- Ax^4 + 4*Ax^3*Bx - 2*Ax^2*Ay^2 + 4*Ax^2*Ay*By - 6*Ax^2*Bx^2 - 2*Ax^2*By^2 + 2*Ax^2*R1^2 + 2*Ax^2*R2^2 + 4*Ax*Ay^2*Bx - 8*Ax*Ay*Bx*By + 4*Ax*Bx^3 + 4*Ax*Bx*By^2 - 4*Ax*Bx*R1^2 - 4*Ax*Bx*R2^2 - Ay^4 + 4*Ay^3*By - 2*Ay^2*Bx^2 - 6*Ay^2*By^2 + 2*Ay^2*R1^2 + 2*Ay^2*R2^2 + 4*Ay*Bx^2*By + 4*Ay*By^3 - 4*Ay*By*R1^2 - 4*Ay*By*R2^2 - Bx^4 - 2*Bx^2*By^2 + 2*Bx^2*R1^2 + 2*Bx^2*R2^2 - By^4 + 2*By^2*R1^2 + 2*By^2*R2^2 - R1^4 + 2*R1^2*R2^2 - R2^4)^(1/2))/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2);
    Qx=Ax/2 + Bx/2 - (Ax*R1^2)/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) + (Ax*R2^2)/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) + (Bx*R1^2)/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) - (Bx*R2^2)/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) - (Ay*(- Ax^4 + 4*Ax^3*Bx - 2*Ax^2*Ay^2 + 4*Ax^2*Ay*By - 6*Ax^2*Bx^2 - 2*Ax^2*By^2 + 2*Ax^2*R1^2 + 2*Ax^2*R2^2 + 4*Ax*Ay^2*Bx - 8*Ax*Ay*Bx*By + 4*Ax*Bx^3 + 4*Ax*Bx*By^2 - 4*Ax*Bx*R1^2 - 4*Ax*Bx*R2^2 - Ay^4 + 4*Ay^3*By - 2*Ay^2*Bx^2 - 6*Ay^2*By^2 + 2*Ay^2*R1^2 + 2*Ay^2*R2^2 + 4*Ay*Bx^2*By + 4*Ay*By^3 - 4*Ay*By*R1^2 - 4*Ay*By*R2^2 - Bx^4 - 2*Bx^2*By^2 + 2*Bx^2*R1^2 + 2*Bx^2*R2^2 - By^4 + 2*By^2*R1^2 + 2*By^2*R2^2 - R1^4 + 2*R1^2*R2^2 - R2^4)^(1/2))/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) + (By*(- Ax^4 + 4*Ax^3*Bx - 2*Ax^2*Ay^2 + 4*Ax^2*Ay*By - 6*Ax^2*Bx^2 - 2*Ax^2*By^2 + 2*Ax^2*R1^2 + 2*Ax^2*R2^2 + 4*Ax*Ay^2*Bx - 8*Ax*Ay*Bx*By + 4*Ax*Bx^3 + 4*Ax*Bx*By^2 - 4*Ax*Bx*R1^2 - 4*Ax*Bx*R2^2 - Ay^4 + 4*Ay^3*By - 2*Ay^2*Bx^2 - 6*Ay^2*By^2 + 2*Ay^2*R1^2 + 2*Ay^2*R2^2 + 4*Ay*Bx^2*By + 4*Ay*By^3 - 4*Ay*By*R1^2 - 4*Ay*By*R2^2 - Bx^4 - 2*Bx^2*By^2 + 2*Bx^2*R1^2 + 2*Bx^2*R2^2 - By^4 + 2*By^2*R1^2 + 2*By^2*R2^2 - R1^4 + 2*R1^2*R2^2 - R2^4)^(1/2))/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2);
 
    Py=Ay/2 + By/2 - (Ay*R1^2)/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) + (Ay*R2^2)/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) + (By*R1^2)/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) - (By*R2^2)/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) - (Ax*(- Ax^4 + 4*Ax^3*Bx - 2*Ax^2*Ay^2 + 4*Ax^2*Ay*By - 6*Ax^2*Bx^2 - 2*Ax^2*By^2 + 2*Ax^2*R1^2 + 2*Ax^2*R2^2 + 4*Ax*Ay^2*Bx - 8*Ax*Ay*Bx*By + 4*Ax*Bx^3 + 4*Ax*Bx*By^2 - 4*Ax*Bx*R1^2 - 4*Ax*Bx*R2^2 - Ay^4 + 4*Ay^3*By - 2*Ay^2*Bx^2 - 6*Ay^2*By^2 + 2*Ay^2*R1^2 + 2*Ay^2*R2^2 + 4*Ay*Bx^2*By + 4*Ay*By^3 - 4*Ay*By*R1^2 - 4*Ay*By*R2^2 - Bx^4 - 2*Bx^2*By^2 + 2*Bx^2*R1^2 + 2*Bx^2*R2^2 - By^4 + 2*By^2*R1^2 + 2*By^2*R2^2 - R1^4 + 2*R1^2*R2^2 - R2^4)^(1/2))/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) + (Bx*(- Ax^4 + 4*Ax^3*Bx - 2*Ax^2*Ay^2 + 4*Ax^2*Ay*By - 6*Ax^2*Bx^2 - 2*Ax^2*By^2 + 2*Ax^2*R1^2 + 2*Ax^2*R2^2 + 4*Ax*Ay^2*Bx - 8*Ax*Ay*Bx*By + 4*Ax*Bx^3 + 4*Ax*Bx*By^2 - 4*Ax*Bx*R1^2 - 4*Ax*Bx*R2^2 - Ay^4 + 4*Ay^3*By - 2*Ay^2*Bx^2 - 6*Ay^2*By^2 + 2*Ay^2*R1^2 + 2*Ay^2*R2^2 + 4*Ay*Bx^2*By + 4*Ay*By^3 - 4*Ay*By*R1^2 - 4*Ay*By*R2^2 - Bx^4 - 2*Bx^2*By^2 + 2*Bx^2*R1^2 + 2*Bx^2*R2^2 - By^4 + 2*By^2*R1^2 + 2*By^2*R2^2 - R1^4 + 2*R1^2*R2^2 - R2^4)^(1/2))/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2);
    Qy=Ay/2 + By/2 - (Ay*R1^2)/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) + (Ay*R2^2)/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) + (By*R1^2)/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) - (By*R2^2)/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) + (Ax*(- Ax^4 + 4*Ax^3*Bx - 2*Ax^2*Ay^2 + 4*Ax^2*Ay*By - 6*Ax^2*Bx^2 - 2*Ax^2*By^2 + 2*Ax^2*R1^2 + 2*Ax^2*R2^2 + 4*Ax*Ay^2*Bx - 8*Ax*Ay*Bx*By + 4*Ax*Bx^3 + 4*Ax*Bx*By^2 - 4*Ax*Bx*R1^2 - 4*Ax*Bx*R2^2 - Ay^4 + 4*Ay^3*By - 2*Ay^2*Bx^2 - 6*Ay^2*By^2 + 2*Ay^2*R1^2 + 2*Ay^2*R2^2 + 4*Ay*Bx^2*By + 4*Ay*By^3 - 4*Ay*By*R1^2 - 4*Ay*By*R2^2 - Bx^4 - 2*Bx^2*By^2 + 2*Bx^2*R1^2 + 2*Bx^2*R2^2 - By^4 + 2*By^2*R1^2 + 2*By^2*R2^2 - R1^4 + 2*R1^2*R2^2 - R2^4)^(1/2))/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2) - (Bx*(- Ax^4 + 4*Ax^3*Bx - 2*Ax^2*Ay^2 + 4*Ax^2*Ay*By - 6*Ax^2*Bx^2 - 2*Ax^2*By^2 + 2*Ax^2*R1^2 + 2*Ax^2*R2^2 + 4*Ax*Ay^2*Bx - 8*Ax*Ay*Bx*By + 4*Ax*Bx^3 + 4*Ax*Bx*By^2 - 4*Ax*Bx*R1^2 - 4*Ax*Bx*R2^2 - Ay^4 + 4*Ay^3*By - 2*Ay^2*Bx^2 - 6*Ay^2*By^2 + 2*Ay^2*R1^2 + 2*Ay^2*R2^2 + 4*Ay*Bx^2*By + 4*Ay*By^3 - 4*Ay*By*R1^2 - 4*Ay*By*R2^2 - Bx^4 - 2*Bx^2*By^2 + 2*Bx^2*R1^2 + 2*Bx^2*R2^2 - By^4 + 2*By^2*R1^2 + 2*By^2*R2^2 - R1^4 + 2*R1^2*R2^2 - R2^4)^(1/2))/(2*Ax^2 - 4*Ax*Bx + 2*Ay^2 - 4*Ay*By + 2*Bx^2 + 2*By^2);    
     
 end
